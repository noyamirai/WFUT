function lazyLoadHandler(o=!1){window.location.toString().includes("squad")&&(console.log("lazy loader"),console.log(o),console.log("NOT CACHED -> WITH TIMEOUT"),setTimeout(()=>{document.querySelectorAll('img[loading="lazy"]').forEach(o=>{o.addEventListener("load",()=>{console.log("The image has finished loading"),setStyling(o)}),o.complete&&(console.log("The image has already finished loading"),setStyling(o))})},1e3))}function setStyling(o){o.classList.remove("hidden"),o.closest("picture").classList.add("loaded")}window.location.toString().includes("squad")&&(console.log("squad page"),lazyLoadHandler());
import{getPageContent,onLinkNavigate}from"/scripts/utils.js";function startViewTransition(e){document.startViewTransition?document.startViewTransition(e):e()}function showLoader(e="main"){var t=document.querySelector(".loader--"+e);"widget"==e?t.closest(".widget").querySelector("[data-widget-content]").classList.add("hide"):document.querySelector("body").classList.add("loading"),t&&t.className.includes("hide")&&t.classList.remove("hide")}function hideLoader(e="main"){var t=document.querySelector(".loader--"+e);"widget"==e?t.closest(".widget").querySelector("[data-widget-content]").classList.remove("hide"):document.querySelector("body").classList.remove("loading"),t&&!t.className.includes("hide")&&t.classList.add("hide")}onLinkNavigate(async({toPath:e,fromPath:t})=>{let a,o=!1;const i=await(await caches.open("other-cache")).match(e);let d="main";i||(e.includes("team-details")&&t.includes("team-details")&&(d="widget"),o=!0,showLoader(d)),console.log("initiating fetch"),a=await getPageContent(e),console.log("cached content: ",i),console.log("loader shown: ",o),console.log(a),o&&(t=(new DOMParser).parseFromString(a,"text/html"),"widget"==d?t.querySelector(".loader--widget").closest(".widget").querySelector("[data-widget-content]").classList.add("hide"):t.querySelector("body").classList.add("loading"),a=t.body.innerHTML),startViewTransition(async()=>{document.body.innerHTML=a,o&&hideLoader(d),lazyLoadHandler(i)})});