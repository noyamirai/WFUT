function lazyLoadHandler(){document.querySelectorAll('img[loading="lazy"]').forEach(e=>{e.addEventListener("load",()=>{console.log("The image has finished loading"),setStyling(e)}),e.complete&&(console.log("The image has already finished loading"),setStyling(e))})}function setStyling(e){e.closest("picture").classList.add("loaded")}lazyLoadHandler();
import{getPageContent,onLinkNavigate}from"/scripts/utils.js";function startViewTransition(e){document.startViewTransition?document.startViewTransition(e):e()}function showLoader(e="main"){var t=document.querySelector(".loader--"+e);"widget"==e?t.closest(".widget").querySelector("[data-widget-content]").classList.add("hide"):document.querySelector("body").classList.add("loading"),t&&t.className.includes("hide")&&t.classList.remove("hide")}function hideLoader(e="main"){var t=document.querySelector(".loader--"+e);"widget"==e?t.closest(".widget").querySelector("[data-widget-content]").classList.remove("hide"):document.querySelector("body").classList.remove("loading"),t&&!t.className.includes("hide")&&t.classList.add("hide")}onLinkNavigate(async({toPath:e,fromPath:t})=>{let a,i=!1,d=!1;var s=await(await caches.open("other-cache")).match(e);let o="main";s||(e.includes("team-details")&&t.includes("team-details")&&(o="widget"),d=!0,showLoader(o)),!s&&e.includes("team-details")&&e.includes("squad")&&(i=!0),a=await getPageContent(e),d&&(t=(new DOMParser).parseFromString(a,"text/html"),"widget"==o?t.querySelector(".loader--widget").closest(".widget").querySelector("[data-widget-content]").classList.add("hide"):t.querySelector("body").classList.add("loading"),a=t.body.innerHTML),startViewTransition(async()=>{document.body.innerHTML=a,i&&lazyLoadHandler(),d&&hideLoader(o)})});